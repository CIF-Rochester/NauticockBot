# The Nauticock Discord Bot

![The Nauticock](https://cdn.discordapp.com/attachments/798075108853809163/1068405103914135623/TheNauticock_-_Copy.png)

Updated for 2023 with new slash commands, using [nextcord](https://github.com/nextcord/nextcord) for the API.

## Prerequisites:
* [Python 3.10+](https://www.python.org/)
* [nextcord](https://pypi.org/project/nextcord/)
* [googleapi](https://developers.google.com/sheets/api/quickstart/python)
## Initialization

* You can install the required packages by running `python3 -m pip install -r requirements.txt`
* Then, create a directory named `keys`.
* Create `discord.txt` and `serverids.txt` inside the `keys` directory.
* Put your discord bot API key into `discord.txt`
* Put the Ids of the servers you would like to allow the bot to be used on in `serverids.txt` on each line.
* To grant access to a participation google sheet, create a `sheets.json` file in keys following the `sheets.template` file. Also add `gcredentials.json` to `./keys`.
* `gcredentials.json` can be generated by following instructions [here](https://developers.google.com/sheets/api/quickstart/python)

## Features Implemented

* New members will automatically be given the "Friends" role.
* Role reaction monitor abilities.
* Simple commands for public use such as /wiki and /website.
* Participation sheet integration with slash commands.

## Code Structure

* `main.py` is the main "executable". It creates a cogs list to use the modules in `cogs/`.
* `utils.py` is for json loading and saving utils.
* `apikeys.py` is for loading api keys and server Ids.
* `sheets.py` is for accessing and automating google sheets. 
* cog modules explained below.
* Sheets systems explained at the end

## Admin.py

* For admin commands, such as `/botsay`.
* Full role monitoring and adding role monitors.
* Only users with the "Board" role can use these commands.

## Greetings.py

* For `on_member_update()` functionality.
* Gives the "Friends" role to new members who pass the rules screening.

## General.py

* For general public use functions such as retrieval of commonly used links.

## Participation.py

* For Board members only, used to grant members participation points automatically.
* /pnew <eventname> <people> <optionaldate>
  * Grants participation points to the people under the target event with name: "eventname date". If a date is not provided, the current date will be used. Can create events
* /pgrant <people>
  * Does the same thing as /pnew only if /pnew has been run once. Grants a point to the people provided to the last event /pnew accessed.

# Sheets modules

## base26.py
* Converts between 'A' column numbering and decimal numbering. 1 = A, 26 = Z. Z+1 = AA

## commandoutput.py
* Used to provide an explicit class for callers of `give_points` and `give_points_can_create`

## participationsheet.py
* Represents many methods involving automating the participation sheet.
* Contains a class `Subsheet` which represents the separate 'Masterlist' and 'Misc' sheets separately.

## semster.py
* Not yet used, will be used to for automating the creation of participation sheets every semester.

## sheets.py
* Connects to the Google API.

## subsheets.py
* Contains the participation sheet subsheets.
* Use `get_sub_sheet(name)` to get either the 'Masterlist' or 'Misc' sheets